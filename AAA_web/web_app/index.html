<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <!-- <link rel="icon" type="image/png" href="/icons/icon-192x192.png" /> -->
    <!-- <link rel="apple-touch-icon" href="/icons/icon-192x192.png" /> -->

    <!-- PWA 매니페스트 (필요시 활성화) -->
    <!-- <link rel="manifest" href="/manifest.json" /> -->

    <!-- 모바일 최적화 메타 태그 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="ASPN AI Agent" />

    <!-- 테마 색상 -->
    <meta name="theme-color" content="#1D4487" />
    <meta name="msapplication-navbutton-color" content="#1D4487" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <!-- SEO 메타 태그 -->
    <meta name="description" content="ASPN AI Agent 모바일 웹 버전 - AI 채팅, 휴가 관리, 전자결재, 기프트, SAP 어시스턴트" />
    <meta name="keywords" content="ASPN, AI, Agent, 모바일, 웹, 채팅, 휴가, 결재, 기프트, SAP" />
    <meta name="author" content="ASPN" />

    <!-- Open Graph 메타 태그 -->
    <meta property="og:title" content="ASPN AI Agent" />
    <meta property="og:description" content="ASPN AI Agent 모바일 웹 버전" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="ASPN AI Agent" />

    <!-- 보안 메타 태그 (X-Frame-Options는 HTTP 헤더로만 설정 가능) -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff" />
    <meta http-equiv="X-XSS-Protection" content="1; mode=block" />

    <!-- 캐시 제어 (개발 모드) -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate, max-age=0" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    
    <title>ASPN AI Agent</title>
    
    <!-- 모바일 최적화 스타일 -->
    <style>
      /* 로딩 스피너 */
      #loading-spinner {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #f5f5f5 0%, #e3f2fd 100%);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        color: #1D4487;
      }
      
      .spinner {
        width: 50px;
        height: 50px;
        border: 4px solid #e3f2fd;
        border-top: 4px solid #1D4487;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      /* 모바일 최적화 */
      * {
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }
      
      input, textarea, select {
        -webkit-user-select: text;
        -moz-user-select: text;
        -ms-user-select: text;
        user-select: text;
      }
      
      /* 스크롤바 숨기기 */
      ::-webkit-scrollbar {
        width: 0px;
        background: transparent;
      }
      
      /* 모바일에서 줌 방지 */
      @media screen and (max-width: 768px) {
        input[type="text"],
        input[type="email"],
        input[type="password"],
        textarea,
        select {
          font-size: 16px !important;
        }
      }
      
      /* 안전 영역 지원 */
      @supports (padding: max(0px)) {
        body {
          padding-left: max(12px, env(safe-area-inset-left));
          padding-right: max(12px, env(safe-area-inset-right));
          padding-top: max(12px, env(safe-area-inset-top));
          padding-bottom: max(12px, env(safe-area-inset-bottom));
        }
      }
    </style>
  </head>
  <body>
    <!-- 로딩 스피너 -->
    <div id="loading-spinner">
      <div class="spinner"></div>
      <div style="font-size: 18px; font-weight: 600;">ASPN AI Agent</div>
      <div style="font-size: 14px; margin-top: 8px; opacity: 0.7;">데스크톱 웹 버전</div>
    </div>
    
    <div id="root"></div>
    
    <!-- 서비스 워커 등록 -->
    <script>
      // 로딩 스피너 숨기기
      window.addEventListener('load', function() {
        setTimeout(function() {
          const spinner = document.getElementById('loading-spinner');
          if (spinner) {
            spinner.style.opacity = '0';
            spinner.style.transition = 'opacity 0.5s ease';
            setTimeout(function() {
              spinner.remove();
            }, 500);
          }
        }, 1000);
      });
      
      // 개발 모드: 기존 Service Worker 제거
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.getRegistrations().then(function(registrations) {
          for (let registration of registrations) {
            registration.unregister().then(function(success) {
              if (success) {
                console.log('Service Worker unregistered successfully');
              }
            });
          }
        });
      }

      // 프로덕션 모드에서만 Service Worker 등록
      // if ('serviceWorker' in navigator && import.meta.env.PROD) {
      //   window.addEventListener('load', function() {
      //     navigator.serviceWorker.register('/sw.js')
      //       .then(function(registration) {
      //         console.log('Service Worker registered successfully:', registration.scope);
      //       })
      //       .catch(function(error) {
      //         console.log('Service Worker registration failed:', error);
      //       });
      //   });
      // }
      
      // PWA 설치 프롬프트
      let deferredPrompt;
      window.addEventListener('beforeinstallprompt', function(e) {
        e.preventDefault();
        deferredPrompt = e;
        
        // 설치 버튼 표시 (필요시)
        console.log('PWA 설치 가능');
      });
      
      // 오프라인 상태 감지
      window.addEventListener('online', function() {
        console.log('온라인 상태');
        // 온라인 상태 알림
      });
      
      window.addEventListener('offline', function() {
        console.log('오프라인 상태');
        // 오프라인 상태 알림
      });
      
      // 모바일 최적화
      if ('ontouchstart' in window) {
        document.body.classList.add('touch-device');
      }
      
      // 뷰포트 높이 조정 (모바일 주소창 고려)
      function setViewportHeight() {
        const vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', vh + 'px');
      }
      
      setViewportHeight();
      window.addEventListener('resize', setViewportHeight);
      window.addEventListener('orientationchange', function() {
        setTimeout(setViewportHeight, 100);
      });
    </script>
    
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
